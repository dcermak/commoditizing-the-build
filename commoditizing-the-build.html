<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Commoditizing the Build</title>
<meta name="author" content="Dan ÄŒermÃ¡k"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./node_modules/reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="./node_modules/reveal.js/dist/theme/simple.css" id="theme"/>

<link rel="stylesheet" href="./node_modules/@fortawesome/fontawesome-free/css/all.min.css"/>

<link rel="stylesheet" href="./custom-style.css"/>
<link rel="stylesheet" href="./node_modules/reveal.js/plugin/highlight/zenburn.css"/>
<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = './node_modules/reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide"><h2 class="title">Commoditizing the Build</h2>
<p class="subtitle" style="color: Gray;">How Containers Save Our Contributor Base</p>
<p class="author">Dan ÄŒermÃ¡k</p>
<div style="float:left"><a href="https://fosdem.org/2026/" target="_blank"><img src="./media/FOSDEM_logo.svg" height="50px" style="margin-bottom:-12px"/> FOSDEM 2026</a></div>
<div style="float:right;font-size:35px;"><p xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#"><a href="https://creativecommons.org/licenses/by/4.0" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">
CC BY 4.0 <i class="fab fa-creative-commons"></i> <i class="fab fa-creative-commons-by"></i></a></p></div>
</section>
<p>
 <script type="text/javascript">hljs.registerLanguage('rpm-specfile', window.hljsDefineRpmSpecfile); hljs.initHighlightingOnLoad(); </script>
</p>
<section>
<section id="slide-org4c06a13">
<h2 id="org4c06a13">who -u</h2>
<p>
Dan ÄŒermÃ¡k
</p>

<p>
 <div style="float:center">
 <table class="who-table">
 <tr><td><i class="fab fa-suse"></i></td><td> Fullstack Developer @SUSE</td></tr>
 <tr><td><i class="fab fa-fedora"></i></td><td> i3 SIG, Package maintainer</td></tr>
 <tr><td><i class="far fa-heart"></i></td><td> Developer Tools, Testing and Documentation, Home Automation</td></tr>
 <tr></tr>
 <tr></tr>
 <tr><td><i class="fa-solid fa-globe"></i></td><td> <a href="https://dancermak.name/">https://dancermak.name</a></td></tr>
 <tr><td><i class="fab fa-github"></i></td><td> <a href="https://github.com/dcermak/">dcermak</a></td></tr>
 <tr><td><i class="fab fa-mastodon"></i></td><td> <a href="https://mastodon.social/@Defolos">@Defolos@mastodon.social</a></td></tr>
 <tr><td><i class="fab fa-bluesky"></i></td><td> <a href="https://bsky.app/profile/defolos.bsky.social">@defolos.bsky.social</a></td></tr>
 </table>
 </div>
</p>
</section>
</section>
<section>
<section id="slide-org0087891">
<h2 id="org0087891">Outline</h2>
<ul>
<li><a href="#/slide-org77080a0">Where are we?</a></li>
<li><a href="#/slide-org5620496">Newcomers</a></li>
<li><a href="#/slide-orgc03175a">Rethinking the Build</a></li>
<li><a href="#/slide-orgf6643fa">RPM-MD Repositories</a></li>

</ul>
</section>
</section>
<section>
<section id="slide-org77080a0">
<h2 id="org77080a0">Where are we?</h2>
<aside class="notes">
<ul>
<li>our contributor base is aging, look around (ML, chat, etc), it's the same people, just getting older</li>
<li>so how does our developer cohort look like: let's start with stackoverflow dev</li>

</ul>

</aside>

<p class="fragment (appear)">
<img src="./media/Tidelift 2024 charts wlogo Fig 12-1.png" height="500px"/>
</p>

</section>
<section id="slide-org77080a0-split">

<p>
<img src="./media/stackoverflow_distribution.svg" height="500px"/>
</p>

</section>
<section id="slide-org77080a0-split">

<p>
<img src="./media/linux_foundation_distribution.svg" height="500px"/>
</p>

</section>
<section id="slide-org77080a0-split">

<p>
<img src="./media/debian_distribution.svg" height="500px"/>
</p>

</section>
<section id="slide-org77080a0-split">

<p>
<img src="./media/opensuse_distribution.svg" height="500px"/>
</p>

</section>
<section id="slide-org77080a0-split">

<p>
<img src="./media/cncf_distribution.svg" height="500px"/>
</p>
</section>
<section id="slide-orgc0299b3">
<h3 id="orgc0299b3">What do Developers want?</h3>
<aside class="notes">
<ul>
<li>stackoverflow 2025 survey, cloud development, AI and Web Dev are the focus</li>
<li>giant shift towards docker &amp; kubernetes: <a href="https://survey.stackoverflow.co/2025/technology/#3-cloud-development">https://survey.stackoverflow.co/2025/technology/#3-cloud-development</a></li>
<li>big shift towards github:
<a href="https://survey.stackoverflow.co/2025/technology/#3-community-platforms">https://survey.stackoverflow.co/2025/technology/#3-community-platforms</a> and
<a href="https://survey.stackoverflow.co/2025/technology/#3-code-documentation-and-collaboration-tools">https://survey.stackoverflow.co/2025/technology/#3-code-documentation-and-collaboration-tools</a></li>
<li>lots of movement towards Go, Rust, Typescript:
<a href="https://survey.stackoverflow.co/2025/technology/#3-programming-scripting-and-markup-languages">https://survey.stackoverflow.co/2025/technology/#3-programming-scripting-and-markup-languages</a></li>

</ul>

</aside>

<p class="fragment (appear)">
<img src="media/stackoverflow-dev-survey-2025-technology-admired-and-desired-platform-desire-admire-social.png"/>
</p>

<p class="fragment (appear)">
<img src="media/stackoverflow-dev-survey-2025-technology-admired-and-desired-office-stack-async-desire-admire-social.png"/>
</p>
</section>
<section id="slide-orgdaa6704">
<h3 id="orgdaa6704">Why aren't we desired?</h3>
<ul>
<li class="fragment appear">our tooling &amp; platforms aren't cool anymore</li>
<li class="fragment appear">our values aren't cool anymore</li>
<li class="fragment appear">ðŸ¤– LLMs are not trained on our tooling</li>
<li class="fragment appear">building a distribution is hardâ„¢ and solved</li>

</ul>

<p class="fragment (appear)">
<img src="./media/linux-distro-build-pipeline.svg"/>
</p>

</section>
<section id="slide-orgdaa6704-split">

<p class="fragment (appear)">
<img src="./media/from-source-to-image.svg"/>
</p>
</section>
</section>
<section>
<section id="slide-org5620496">
<h2 id="org5620496">Omarchy</h2>
<aside class="notes">
<ul>
<li>very popular Linux spin based on Arch</li>
<li>super opinionated Hyprland setup</li>
<li>mostly shell scripts</li>

</ul>
<p>
&rarr; too simple for a general purpose distribution
</p>

</aside>

<ul>
<li class="fragment appear">Opinionated Arch Linux spin with Hyprland</li>
<li class="fragment appear">Community on <i class="fa-brands fa-github"></i> Github &amp; <i class="fa-brands fa-discord"></i> Discord</li>

</ul>

<p class="fragment (appear)">
<img src="./media/omarchy-github-languages.png"/>
</p>
</section>
</section>
<section>
<section id="slide-orgc9efe27">
<h2 id="orgc9efe27">Universal Blue</h2>
<p>
<img src="./media/ublue.svg" />
</p>

<blockquote  class="fragment (appear)" data-fragment-index="0">
<p>
This is a tool that allows cloud infrastructure people to use their skills to help the Linux desktop
</p>
</blockquote>
<p data-fragment-index="0" class="fragment (appear)">
uBlue - <a href="https://universal-blue.org/#who" data-fragment-index="0" class="fragment (appear)">Who We Are</a>
</p>
</section>
<section id="slide-org6ea108c">
<h3 id="org6ea108c">Stack</h3>
<ul>
<li class="fragment appear"><a href="https://bootc-dev.github.io/bootc/">bootc</a> + <code>Dockerfile</code></li>
<li class="fragment appear"><i class="fa-brands fa-github"></i> Github &amp; Github Actions</li>
<li class="fragment appear">Community on <i class="fa-brands fa-discord"></i> Discord and
<i class="fa-brands fa-discourse"></i> Discourse</li>

</ul>
</section>
<section id="slide-org6690a43">
<h3 id="org6690a43"><span class="todo TODO">TODO</span> Contributors</h3>
<p class="fragment (appear)">
<img src="./media/ublue-contributors-2024.png"/>
</p>
</section>
</section>
<section>
<section id="slide-orgb686c92">
<h2 id="orgb686c92">Take Away</h2>
<p>
Developers like:
</p>
<ul>
<li class="fragment appear"><i class="fa-brands fa-github"></i> Github</li>
<li class="fragment appear"><i class="fa-brands fa-discord"></i> Discord</li>
<li class="fragment appear">opinionated distributions</li>
<li class="fragment appear">their tooling (Bash + Docker <i class="fa-brands fa-docker"></i>)</li>

</ul>

<p class="fragment (appear)">
Can we use more container tooling?
</p>
</section>
<section id="slide-orgc03175a">
<h3 id="orgc03175a">The Build Recipe</h3>
<div class="org-src-container">

<pre  class="fragment (appear)"  ><code class="spec" data-line-numbers='|1-4|5-9|11-13|15-19|21-23|25-28|30-31|33-37|39-51|53-54|'>Summary:	Extensible editor for structured binary data
Name:		poke
Version:	4.3
Release:	%autorelease

License:	GPL-3.0-or-later AND GFDL-1.3-no-invariants-or-later
URL:		https://www.jemarch.net/poke
Source0:	https://ftp.gnu.org/gnu/%{name}/%{name}-%{version}.tar.gz
Source1:	https://ftp.gnu.org/gnu/%{name}/%{name}-%{version}.tar.gz.sig

BuildRequires:	emacs
BuildRequires:	gcc
BuildRequires:	gc-devel

%description
GNU poke is an interactive, extensible editor for binary data. Not
limited to editing basic entities such as bits and bytes, it provides
a full-fledged procedural, interactive programming language designed
to describe data structures and to operate on them.

%prep
%{gpgverify} --keyring='%{SOURCE2}' --signature='%{SOURCE1}' --data='%{SOURCE0}'
%autosetup

%build
%define _lto_cflags %{nil}
%configure
%make_build

%check
make check

%install
%{make_install}
rm -f %{buildroot}/%{_infodir}/dir
rm -f %{buildroot}%{_libdir}/libpoke.a
rm -f %{buildroot}%{_libdir}/libpoke.la

%files
%{_bindir}/%{name}
%{_bindir}/poked
%{_bindir}/pokefmt
%{_bindir}/pk-bin2poke
%{_bindir}/pk-jojopatch
%{_bindir}/pk-strings
%{_infodir}/poke.info*.*
%{_mandir}/man1/%{name}.1*
%{_mandir}/man1/poked.1*
%{_mandir}/man1/pokefmt.1*
%doc AUTHORS ChangeLog NEWS README TODO
%license COPYING

%changelog
%autochangelog
</code></pre>
</div>
</section>
<section id="slide-org56d15ec">
<h3 id="org56d15ec">Is it that much different to this?</h3>
<div class="org-src-container">

<pre  class="fragment (appear)"  ><code class="Dockerfile" data-line-numbers='|1-3|5-7|9|11-17|19|21|23-27|29|'>ARG VERSION=4.3
ARG DIST
FROM fedora-rpm-buildroot:${DIST} as buildrequires

WORKDIR /src/
COPY poke-${VERSION}.tar.gz .
COPY poke-${VERSION}.tar.gz.sig .

RUN dnf -y install emacs gcc gc-devel nbdkit make

FROM localhost/poke-buildrequires as builder

RUN rpmdev-extract poke-${VERSION}.tar.gz
WORKDIR /src/poke-${VERSION}
RUN ./configure; \
    make build; \
    make check

RUN make install PREFIX=/usr/local

FROM fedora-rpm-buildroot:${DIST} as poke

LABEL org.opencontainers.image.version=${VERSION}
LABEL org.opencontainers.image.url="https://www.jemarch.net/poke"
LABEL org.opencontainers.image.title="Extensible editor for structured binary data"
LABEL org.opencontainers.image.description="GNU poke is an interactive, extensible editor for binary data."
LABEL org.opencontainers.image.licenses="GPL-3.0-or-later AND GFDL-1.3-no-invariants-or-later"

COPY --from=builder /usr/local/bin /usr/bin
</code></pre>
</div>
</section>
</section>
<section>
<section id="slide-org731238f">
<h2 id="org731238f">Introducing: <i class="fa-brands fa-github"></i> <a href="https://github.com/dcermak/roci"><code>dcermak/roci</code></a></h2>
<aside class="notes">
<p>
most pressing problems:
</p>
<ul>
<li>network isolation, actually kinda easy to solve, via multistage builds</li>
<li>AutoReqProv: rpm's dependency/provides generators. Absolutely required if you don't want packaging to suck. Solved by running <code>rpmdeps</code></li>
<li></li>

</ul>

</aside>

<p class="fragment (appear)">
builds rpms from a <code>Dockerfile</code>
</p>

<ul>
<li class="fragment appear">sections &rArr; stages</li>
<li class="fragment appear"><code>%files</code> &rArr; <code>COPY --from=builder</code></li>
<li class="fragment appear">macros &rArr; build arguments, scripts, ENV variables</li>
<li class="fragment appear">Preamble &rArr; <code>LABEL</code> + config file</li>
<li class="fragment appear">scriptlets &rArr; config file</li>
<li class="fragment appear"><code>mock</code> / <code>obs-build</code> &rArr; <code>buildah</code></li>

</ul>
</section>
<section id="slide-org600e8a7">
<h3 id="org600e8a7">Issues to tackle</h3>
<aside class="notes">
<ul>
<li>reproducible builds: kinda important, should be mostly doable by setting <code>SOURCE_DATE_EPOCH</code> ðŸ¤ž</li>
<li>macros: huge issue, rpm has</li>

</ul>

</aside>

<ul>
<li class="fragment appear">dependency generation (<code>AutoReqProv</code>)</li>
<li class="fragment appear">reproducible builds</li>
<li class="fragment appear">debuginfo</li>
<li class="fragment appear">changelogs</li>
<li class="fragment appear">macros</li>
<li class="fragment appear">file lists</li>

</ul>

</section>
<section id="slide-org600e8a7-split">

<p>
<img src="./media/roci-build.svg"/>
</p>
</section>
<section id="slide-orgcceaf4a">
<h3 id="orgcceaf4a">Macros</h3>
<ul>
<li class="fragment appear">Turing complete m4 &amp; cpp inspired language</li>
<li class="fragment appear">embedded Lua interpreter &amp; shell expansion</li>
<li class="fragment appear">recursive text expansion</li>

</ul>

<p class="fragment (appear)">
Typical usage:
</p>
<ul>
<li class="fragment appear">variables: <code>%build_cflags</code></li>
<li class="fragment appear">conditionals: <code>%if %cond %endif</code></li>
<li class="fragment appear">"functions": <code>%pytest</code></li>
<li class="fragment appear">sections: <code>%prep</code></li>

</ul>
</section>
<section id="slide-org58feec8">
<h3 id="org58feec8">Filelists</h3>
<div class="org-src-container">

<pre   ><code class="spec" >%files -f my-list.txt
%{_bindir}/%{name}
%config %{_sysconfdir}/%{name}.defaults
%config(noreplace) %{_sysconfdir}/%{name}
%doc README
%license COPYING
</code></pre>
</div>
</section>
</section>
<section>
<section id="slide-org61d5b0e">
<h2 id="org61d5b0e">What's a package?</h2>
<p class="fragment (appear)">
<img src="./media/rpm-package.svg"/>
</p>
</section>
<section id="slide-org637fbcf">
<h3 id="org637fbcf">What's a OCI Image?</h3>
<p class="fragment (appear)">
<img src="./media/oci-image.svg"/>
</p>
</section>
<section id="slide-orgf79bfad">
<h3 id="orgf79bfad">RPM + OCI</h3>
<p class="fragment (appear)">
<img src="./media/roci-build-to-oci.svg"/>
</p>

</section>
<section id="slide-orgf79bfad-split">

<div class="org-src-container">

<pre  class="fragment (appear)"  ><code class="json" data-line-numbers='|3-4|5-9|10-16|17-21|'>{
  "schemaVersion": 2,
  "mediaType": "application/vnd.oci.image.manifest.v1+json",
  "artifactType": "application/vnd.rpm.package.v7",
  "config": {
    "mediaType": "application/vnd.rpm.package.header.v1+json",
    "digest": "sha256:b5b2b2c507a0944348e0303114d8d93aaaa081732b86451d9bce1f432a537bc7",
    "size": 7023
  },
  "layers": [
    {
      "mediaType": "application/vnd.oci.image.layer.v1.tar+gzip",
      "digest": "sha256:9834876dcfb05cb167a5c24953eba58c4ac89b1adf57f28f2f9d09af107ee8f0",
      "size": 32654
    }
  ],
  "subject": {
    "mediaType": "application/vnd.oci.image.manifest.v1+json",
    "digest": "sha256:5b0bcabd1ed22e9fb1310cf6c2dec7cdef19f0ad69efa1f392e94a4333501270",
    "size": 7682
  }
}
</code></pre>
</div>
</section>
</section>
<section>
<section id="slide-orgf6643fa">
<h2 id="orgf6643fa">RPM-MD Repositories</h2>
<aside class="notes">
<ul>
<li>metadata live in <code>repodata/</code> subdir (by convention, only repomd.xml must be there)</li>
<li>repomd.xml: only location + checksum to the other files:</li>
<li>primary.xml: has links to all rpms + requires and some provides</li>
<li>filelist.xml: list of all files per rpm (useful for installing binaries by path)</li>
<li>other.xml: just the package changelog</li>

</ul>

</aside>

<div class="org-src-container">

<pre  class="fragment (appear)"  ><code class="txt" data-line-numbers='|10|7-9|9|2-5|'>â””â”€â”€ os
    â”œâ”€â”€ Packages
    â”‚Â Â  â””â”€â”€ 0
    â”‚Â Â      â”œâ”€â”€ 0ad-0.27.1-4.fc43.x86_64.rpm
    â”‚Â Â      â””â”€â”€ 0ad-data-0.27.1-2.fc43.noarch.rpm
    â””â”€â”€ repodata
        â”œâ”€â”€ &lt;checksum&gt;-filelist.xml.zck
        â”œâ”€â”€ &lt;checksum&gt;-other.xml.zck
        â”œâ”€â”€ &lt;checksum&gt;-primary.xml.zck
        â””â”€â”€ repomd.xml
</code></pre>
</div>

</section>
<section id="slide-orgf6643fa-split">
<p>
<code>primary.xml</code>
</p>

<div class="org-src-container">

<pre  class="fragment (appear)"  ><code class="xml" data-line-numbers='|3-25|4-9|10-24|14-17|18-22|'>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;metadata xmlns="http://linux.duke.edu/metadata/common" xmlns:rpm="http://linux.duke.edu/metadata/rpm" packages="77664"&gt;
&lt;package type="rpm"&gt;
  &lt;name&gt;0ad&lt;/name&gt;
  &lt;arch&gt;x86_64&lt;/arch&gt;
  &lt;version epoch="0" ver="0.27.1" rel="4.fc43"/&gt;
  &lt;checksum type="sha256" pkgid="YES"&gt;3f2334239f14e388571e001bbc966db7f23ad04583c5bbd2156fa1cf71f55add&lt;/checksum&gt;
  &lt;!-- snip --&gt;
  &lt;location href="Packages/0/0ad-0.27.1-4.fc43.x86_64.rpm"/&gt;
  &lt;format&gt;
    &lt;!-- snip --&gt;
    &lt;rpm:sourcerpm&gt;0ad-0.27.1-4.fc43.src.rpm&lt;/rpm:sourcerpm&gt;
    &lt;rpm:header-range start="29152" end="67261"/&gt;
    &lt;rpm:provides&gt;
      &lt;rpm:entry name="0ad" flags="EQ" epoch="0" ver="0.27.1" rel="4.fc43"/&gt;
      &lt;!-- snip --&gt;
    &lt;/rpm:provides&gt;
    &lt;rpm:requires&gt;
      &lt;rpm:entry name="/usr/bin/sh"/&gt;
      &lt;rpm:entry name="0ad-data" flags="EQ" epoch="0" ver="0.27.1"/&gt;
      &lt;!-- and more --&gt;
    &lt;/rpm:requires&gt;
    &lt;file&gt;/usr/bin/0ad&lt;/file&gt;
  &lt;/format&gt;
&lt;/package&gt;
</code></pre>
</div>

<ul>
<li class="fragment appear">repomd.xml</li>
<li class="fragment appear">files</li>

</ul>
</section>
</section>
<section>
<section id="slide-org55d5daf">
<h2 id="org55d5daf">Call to Action!</h2>
<p class="fragment (appear)">
Rethink our tooling to simplify onboarding for the next generation
</p>

<p>
 <div style="float:center" data-fragment="2" class="fragment (appear)">
 <table class="qr-table">
 <tr><td><img src="./media/qr-roci.svg" height="300px"/></td><td><img src="./media/qr-presentation.svg" height="300px"/></td></tr>
 <tr><td style="text-align: center;"><i class="fab fa-github"></i> <a href="https://github.com/dcermak/roci">roci</a></td><td><a href="https://github.com/dcermak/commoditizing-the-build">slides</a></td></tr>
 </table>
 </div>
</p>
</section>
</section>
</div>
</div>
<script src="./node_modules/reveal.js/dist/reveal.js"></script>
<script src="./node_modules/reveal.js/plugin/highlight/highlight.js"></script>
<script src="./node_modules/reveal.js/plugin/notes/notes.js"></script>


<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
plugins: [RevealHighlight, RevealNotes, history],
transition: 'none', hash: true
});

</script>
<script src="./node_modules/highlightjs-rpm-specfile/rpm-specfile.js"></script>
</body>
</html>
